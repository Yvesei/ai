root@server3:/home/student# python3 all_3.py
================================================================================
LOADING EXTRACTED FLOWS FROM CSV
================================================================================
Found 53 CSV files
  Loaded log_45.csv: 19257 flows
    Columns: ['first_timestamp', 'last_timestamp', 'ip_src', 'ip_dst', 'port_src', 'port_dst', 'protocol', 'application_name', 'duration', 'packets', 'bytes', 'bytes_rev', 'packets_src2dst', 'packets_dst2src', 'bytes_src2dst', 'bytes_dst2src', 'mean_ps', 'stddev_ps', 'mean_piat_ms', 'stddev_piat_ms', 'syn_packets', 'ack_packets', 'fin_packets', 'rst_packets', 'psh_packets']
  Loaded log_40.csv: 20941 flows
  Loaded log_17.csv: 20082 flows
  Loaded log_15.csv: 21081 flows
  Loaded log_37.csv: 21634 flows
  Loaded log_12.csv: 19826 flows
  Loaded log_25.csv: 20802 flows
  Loaded log_27.csv: 17501 flows
  Loaded log_44.csv: 17909 flows
  Loaded log_42.csv: 18396 flows
  Loaded log_16.csv: 20535 flows
  Loaded log_38.csv: 20679 flows
  Loaded log_29.csv: 18727 flows
  Loaded log_3.csv: 18430 flows
  Loaded log_28.csv: 18294 flows
  Loaded log_13.csv: 17582 flows
  Loaded log_8.csv: 18742 flows
  Loaded log_30.csv: 19023 flows
  Loaded log_49.csv: 21207 flows
  Loaded log_32.csv: 17665 flows
  Loaded log_35.csv: 16779 flows
  Loaded log_4.csv: 18902 flows
  Loaded log_19.csv: 17677 flows
  Loaded log_46.csv: 18156 flows
  Loaded log_9.csv: 18143 flows
  Loaded log_2.csv: 16798 flows
  Loaded log_48.csv: 21783 flows
  Loaded log_21.csv: 17665 flows
  Loaded log_1.csv: 23019 flows
  Loaded log_53.csv: 13030 flows
  Loaded log_10.csv: 21963 flows
  Loaded log_34.csv: 18563 flows
  Loaded log_47.csv: 19268 flows
  Loaded log_23.csv: 18576 flows
  Loaded log_14.csv: 18516 flows
  Loaded log_6.csv: 18724 flows
  Loaded log_50.csv: 21986 flows
  Loaded log_33.csv: 17960 flows
  Loaded log_7.csv: 21135 flows
  Loaded log_26.csv: 20633 flows
  Loaded log_36.csv: 22591 flows
  Loaded log_52.csv: 17665 flows
  Loaded log_51.csv: 18619 flows
  Loaded log_22.csv: 18072 flows
  Loaded log_20.csv: 20510 flows
  Loaded log_41.csv: 27382 flows
  Loaded log_39.csv: 19001 flows
  Loaded log_5.csv: 20015 flows
  Loaded log_24.csv: 20074 flows
  Loaded log_31.csv: 24345 flows
  Loaded log_11.csv: 18030 flows
  Loaded log_18.csv: 19273 flows
  Loaded log_43.csv: 16281 flows

Total flows loaded: 1029447
Columns: ['first_timestamp', 'last_timestamp', 'ip_src', 'ip_dst', 'port_src', 'port_dst', 'protocol', 'application_name', 'duration', 'packets', 'bytes', 'bytes_rev', 'packets_src2dst', 'packets_dst2src', 'bytes_src2dst', 'bytes_dst2src', 'mean_ps', 'stddev_ps', 'mean_piat_ms', 'stddev_piat_ms', 'syn_packets', 'ack_packets', 'fin_packets', 'rst_packets', 'psh_packets']

First few rows:
   first_timestamp  last_timestamp         ip_src         ip_dst  port_src  port_dst  protocol  ... mean_piat_ms  stddev_piat_ms  syn_packets  ack_packets  fin_packets  rst_packets  psh_packets
0     1.421966e+09    1.421966e+09  149.171.126.3     59.166.0.5        80      8976         6  ...     3.493438       29.648788            0          382            4            0          128
1     1.421966e+09    1.421966e+09     59.166.0.7  149.171.126.7     39901       143         6  ...    15.372093       86.075831            0           44            4            0           20
2     1.421966e+09    1.421966e+09     59.166.0.8  149.171.126.4     16043     41715         6  ...     0.265306        0.446071            0           50            4            0           22
3     1.421966e+09    1.421966e+09     59.166.0.8  149.171.126.2     63681     37112         6  ...     0.464088        0.963260            4          180            4            0           88
4     1.421966e+09    1.421966e+09     59.166.0.5  149.171.126.8     14484        80         6  ...    47.600000      205.346658            0           26            4            0           10

[5 rows x 25 columns]

Adding fan-in and fan-out features (vectorized)...
Available columns: ['first_timestamp', 'last_timestamp', 'ip_src', 'ip_dst', 'port_src', 'port_dst', 'protocol', 'application_name', 'duration', 'packets', 'bytes', 'bytes_rev', 'packets_src2dst', 'packets_dst2src', 'bytes_src2dst', 'bytes_dst2src', 'mean_ps', 'stddev_ps', 'mean_piat_ms', 'stddev_piat_ms', 'syn_packets', 'ack_packets', 'fin_packets', 'rst_packets', 'psh_packets']
  Sorted by first_timestamp
 Fan-in and fan-out features added
  fan_out_src range: 1 to 10
  fan_in_dst range: 1 to 10

Loading ground truth...
File: ./TRAIN/TRAIN.gt
   Successfully read with comma delimiter and header=0
  Shape: (7931, 8)
  Columns: ['first_timestamp_ms', 'last_timestamp_ms', 'src_ip', 'src_port', 'dst_ip', 'dst_port', 'protocol', 'label']
  First row:
first_timestamp_ms    1421931432000.0
last_timestamp_ms     1421931433000.0
src_ip                   175.45.176.2
src_port                        54280
dst_ip                 149.171.126.17
dst_port                          135
protocol                            6
label                               1
Name: 0, dtype: object
   Ground truth flows: 7931
  Sample row:
first_timestamp_ms    1421931432000.0
last_timestamp_ms     1421931433000.0
src_ip                   175.45.176.2
src_port                        54280
dst_ip                 149.171.126.17
dst_port                          135
protocol                            6
label                               1
Name: 0, dtype: object

Labeling flows with ground truth...
  Labeled 5000 flows
  Labeled 10000 flows
  Labeled 15000 flows
  Labeled 20000 flows
  Labeled 25000 flows
  Labeled 30000 flows
  Labeled 35000 flows
  Labeled 40000 flows
  Labeled 45000 flows
  Labeled 50000 flows
  Labeled 55000 flows
  Labeled 60000 flows
  Labeled 65000 flows
  Labeled 70000 flows
  Labeled 75000 flows
  Labeled 80000 flows
  Labeled 85000 flows
  Labeled 90000 flows
  Labeled 95000 flows
  Labeled 100000 flows
  Labeled 105000 flows
  Labeled 110000 flows
  Labeled 115000 flows
  Labeled 120000 flows
  Labeled 125000 flows
  Labeled 130000 flows
  Labeled 135000 flows
  Labeled 140000 flows
  Labeled 145000 flows
  Labeled 150000 flows
  Labeled 155000 flows
  Labeled 160000 flows
  Labeled 165000 flows
  Labeled 170000 flows
  Labeled 175000 flows
  Labeled 180000 flows
  Labeled 185000 flows
  Labeled 190000 flows
  Labeled 195000 flows
  Labeled 200000 flows
  Labeled 205000 flows
  Labeled 210000 flows
  Labeled 215000 flows
  Labeled 220000 flows
  Labeled 225000 flows
  Labeled 230000 flows
  Labeled 235000 flows
  Labeled 240000 flows
  Labeled 245000 flows
  Labeled 250000 flows
  Labeled 255000 flows
  Labeled 260000 flows
  Labeled 265000 flows
  Labeled 270000 flows
  Labeled 275000 flows
  Labeled 280000 flows
  Labeled 285000 flows
  Labeled 290000 flows
  Labeled 295000 flows
  Labeled 300000 flows
  Labeled 305000 flows
  Labeled 310000 flows
  Labeled 315000 flows
  Labeled 320000 flows
  Labeled 325000 flows
  Labeled 330000 flows
  Labeled 335000 flows
  Labeled 340000 flows
  Labeled 345000 flows
  Labeled 350000 flows
  Labeled 355000 flows
  Labeled 360000 flows
  Labeled 365000 flows
  Labeled 370000 flows
  Labeled 375000 flows
  Labeled 380000 flows
  Labeled 385000 flows
  Labeled 390000 flows
  Labeled 395000 flows
  Labeled 400000 flows
  Labeled 405000 flows
  Labeled 410000 flows
  Labeled 415000 flows
  Labeled 420000 flows
  Labeled 425000 flows
  Labeled 430000 flows
  Labeled 435000 flows
  Labeled 440000 flows
  Labeled 445000 flows
  Labeled 450000 flows
  Labeled 455000 flows
  Labeled 460000 flows
  Labeled 465000 flows
  Labeled 470000 flows
  Labeled 475000 flows
  Labeled 480000 flows
  Labeled 485000 flows
  Labeled 490000 flows
  Labeled 495000 flows
  Labeled 500000 flows
  Labeled 505000 flows
  Labeled 510000 flows
  Labeled 515000 flows
  Labeled 520000 flows
  Labeled 525000 flows
  Labeled 530000 flows
  Labeled 535000 flows
  Labeled 540000 flows
  Labeled 545000 flows
  Labeled 550000 flows
  Labeled 555000 flows
  Labeled 560000 flows
  Labeled 565000 flows
  Labeled 570000 flows
  Labeled 575000 flows
  Labeled 580000 flows
  Labeled 585000 flows
  Labeled 590000 flows
  Labeled 595000 flows
  Labeled 600000 flows
  Labeled 605000 flows
  Labeled 610000 flows
  Labeled 615000 flows
  Labeled 620000 flows
  Labeled 625000 flows
  Labeled 630000 flows
  Labeled 635000 flows
  Labeled 640000 flows
  Labeled 645000 flows
  Labeled 650000 flows
  Labeled 655000 flows
  Labeled 660000 flows
  Labeled 665000 flows
  Labeled 670000 flows
  Labeled 675000 flows
  Labeled 680000 flows
  Labeled 685000 flows
  Labeled 690000 flows
  Labeled 695000 flows
  Labeled 700000 flows
  Labeled 705000 flows
  Labeled 710000 flows
  Labeled 715000 flows
  Labeled 720000 flows
  Labeled 725000 flows
  Labeled 730000 flows
  Labeled 735000 flows
  Labeled 740000 flows
  Labeled 745000 flows
  Labeled 750000 flows
  Labeled 755000 flows
  Labeled 760000 flows
  Labeled 765000 flows
  Labeled 770000 flows
  Labeled 775000 flows
  Labeled 780000 flows
  Labeled 785000 flows
  Labeled 790000 flows
  Labeled 795000 flows
  Labeled 800000 flows
  Labeled 805000 flows
  Labeled 810000 flows
  Labeled 815000 flows
  Labeled 820000 flows
  Labeled 825000 flows
  Labeled 830000 flows
  Labeled 835000 flows
  Labeled 840000 flows
  Labeled 845000 flows
  Labeled 850000 flows
  Labeled 855000 flows
  Labeled 860000 flows
  Labeled 865000 flows
  Labeled 870000 flows
  Labeled 875000 flows
  Labeled 880000 flows
  Labeled 885000 flows
  Labeled 890000 flows
  Labeled 895000 flows
  Labeled 900000 flows
  Labeled 905000 flows
  Labeled 910000 flows
  Labeled 915000 flows
  Labeled 920000 flows
  Labeled 925000 flows
  Labeled 930000 flows
  Labeled 935000 flows
  Labeled 940000 flows
  Labeled 945000 flows
  Labeled 950000 flows
  Labeled 955000 flows
  Labeled 960000 flows
  Labeled 965000 flows
  Labeled 970000 flows
  Labeled 975000 flows
  Labeled 980000 flows
  Labeled 985000 flows
  Labeled 990000 flows
  Labeled 995000 flows
  Labeled 1000000 flows
  Labeled 1005000 flows
  Labeled 1010000 flows
  Labeled 1015000 flows
  Labeled 1020000 flows
  Labeled 1025000 flows

Attack flows: 7944 (0.77%)
Normal flows: 1021503 (99.23%)

Vectorizing flows...
Available columns: ['first_timestamp', 'last_timestamp', 'ip_src', 'ip_dst', 'port_src', 'port_dst', 'protocol', 'application_name', 'duration', 'packets', 'bytes', 'bytes_rev', 'packets_src2dst', 'packets_dst2src', 'bytes_src2dst', 'bytes_dst2src', 'mean_ps', 'stddev_ps', 'mean_piat_ms', 'stddev_piat_ms', 'syn_packets', 'ack_packets', 'fin_packets', 'rst_packets', 'psh_packets', 'fan_out_src', 'fan_in_dst', 'label']
Using 18 features: ['duration', 'packets', 'bytes', 'bytes_rev', 'fan_out_src', 'fan_in_dst', 'port_src', 'port_dst', 'packets_src2dst', 'packets_dst2src', 'mean_ps', 'stddev_ps', 'mean_piat_ms', 'stddev_piat_ms', 'syn_packets', 'ack_packets', 'fin_packets', 'rst_packets']
 Vectorization complete: (1029447, 18)

================================================================================
SETTING UP CROSS-VALIDATION BY APPLICATION
================================================================================

HTTP: 95262 flows
  Train: 76209, Test: 19053
  Train attacks: 1957, Test attacks: 489

IMAP: 483 flows
  Train: 386, Test: 97
  Train attacks: 206, Test attacks: 52

DNS: 193360 flows
  Train: 154688, Test: 38672
  Train attacks: 57, Test attacks: 14

SMTP: 43804 flows
  Train: 35043, Test: 8761
  Train attacks: 597, Test attacks: 149

ICMP: 51 flows
  Train: 40, Test: 11
  Train attacks: 0, Test attacks: 0

SSH: 25855 flows
  Train: 20684, Test: 5171
  Train attacks: 2, Test attacks: 1
Skipping FTP (insufficient flows: 0)
Skipping FTP (insufficient flows: 0)

================================================================================
CLASSIFYING: HTTP
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(74252), np.int64(1): np.int64(1957)}
Test set - Class distribution: {np.int64(0): np.int64(18564), np.int64(1): np.int64(489)}

Fold 1:
  Train classes: (array([0, 1]), array([59401,  1566]))
  Val classes: (array([0, 1]), array([14851,   391]))
  k-NN - Acc: 0.9908, Prec: 0.8210, Rec: 0.8210, F1: 0.8210
  NB  - Acc: 0.9743, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 2:
  Train classes: (array([0, 1]), array([59401,  1566]))
  Val classes: (array([0, 1]), array([14851,   391]))
  k-NN - Acc: 0.9902, Prec: 0.8103, Rec: 0.8082, F1: 0.8092
  NB  - Acc: 0.9743, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 3:
  Train classes: (array([0, 1]), array([59402,  1565]))
  Val classes: (array([0, 1]), array([14850,   392]))
  k-NN - Acc: 0.9915, Prec: 0.8243, Rec: 0.8495, F1: 0.8367
  NB  - Acc: 0.9743, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 4:
  Train classes: (array([0, 1]), array([59402,  1565]))
  Val classes: (array([0, 1]), array([14850,   392]))
  k-NN - Acc: 0.9899, Prec: 0.7960, Rec: 0.8163, F1: 0.8060
  NB  - Acc: 0.9743, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 5:
  Train classes: (array([0, 1]), array([59402,  1566]))
  Val classes: (array([0, 1]), array([14850,   391]))
  k-NN - Acc: 0.9905, Prec: 0.8342, Rec: 0.7852, F1: 0.8090
  NB  - Acc: 0.9743, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Test Set (19053 samples):
  k-NN - Acc: 0.9907, F1: 0.8169
  NB   - Acc: 0.9743, F1: 0.0000

================================================================================
CLASSIFYING: IMAP
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(180), np.int64(1): np.int64(206)}
Test set - Class distribution: {np.int64(0): np.int64(45), np.int64(1): np.int64(52)}

Fold 1:
  Train classes: (array([0, 1]), array([144, 164]))
  Val classes: (array([0, 1]), array([36, 42]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000

Fold 2:
  Train classes: (array([0, 1]), array([144, 165]))
  Val classes: (array([0, 1]), array([36, 41]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000

Fold 3:
  Train classes: (array([0, 1]), array([144, 165]))
  Val classes: (array([0, 1]), array([36, 41]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000

Fold 4:
  Train classes: (array([0, 1]), array([144, 165]))
  Val classes: (array([0, 1]), array([36, 41]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000

Fold 5:
  Train classes: (array([0, 1]), array([144, 165]))
  Val classes: (array([0, 1]), array([36, 41]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000

Test Set (97 samples):
  k-NN - Acc: 1.0000, F1: 1.0000
  NB   - Acc: 1.0000, F1: 1.0000

================================================================================
CLASSIFYING: DNS
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(154631), np.int64(1): np.int64(57)}
Test set - Class distribution: {np.int64(0): np.int64(38658), np.int64(1): np.int64(14)}

Fold 1:
  Train classes: (array([0, 1]), array([123704,     46]))
  Val classes: (array([0, 1]), array([30927,    11]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 0.9091, F1: 0.9524
  NB  - Acc: 0.9996, Prec: 0.4762, Rec: 0.9091, F1: 0.6250

Fold 2:
  Train classes: (array([0, 1]), array([123705,     45]))
  Val classes: (array([0, 1]), array([30926,    12]))
  k-NN - Acc: 1.0000, Prec: 0.9231, Rec: 1.0000, F1: 0.9600
  NB  - Acc: 0.9997, Prec: 0.5789, Rec: 0.9167, F1: 0.7097

Fold 3:
  Train classes: (array([0, 1]), array([123705,     45]))
  Val classes: (array([0, 1]), array([30926,    12]))
  k-NN - Acc: 0.9999, Prec: 1.0000, Rec: 0.8333, F1: 0.9091
  NB  - Acc: 0.9998, Prec: 0.6667, Rec: 0.8333, F1: 0.7407

Fold 4:
  Train classes: (array([0, 1]), array([123705,     46]))
  Val classes: (array([0, 1]), array([30926,    11]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 0.9091, F1: 0.9524
  NB  - Acc: 0.9996, Prec: 0.4737, Rec: 0.8182, F1: 0.6000

Fold 5:
  Train classes: (array([0, 1]), array([123705,     46]))
  Val classes: (array([0, 1]), array([30926,    11]))
  k-NN - Acc: 1.0000, Prec: 0.9167, Rec: 1.0000, F1: 0.9565
  NB  - Acc: 0.9995, Prec: 0.4091, Rec: 0.8182, F1: 0.5455

Test Set (38672 samples):
  k-NN - Acc: 0.9999, F1: 0.8571
  NB   - Acc: 0.9997, F1: 0.6471

================================================================================
CLASSIFYING: SMTP
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(34446), np.int64(1): np.int64(597)}
Test set - Class distribution: {np.int64(0): np.int64(8612), np.int64(1): np.int64(149)}

Fold 1:
  Train classes: (array([0, 1]), array([27556,   478]))
  Val classes: (array([0, 1]), array([6890,  119]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 0.9827, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 2:
  Train classes: (array([0, 1]), array([27557,   477]))
  Val classes: (array([0, 1]), array([6889,  120]))
  k-NN - Acc: 0.9997, Prec: 0.9836, Rec: 1.0000, F1: 0.9917
  NB  - Acc: 0.9829, Prec: 0.5000, Rec: 0.0083, F1: 0.0164

Fold 3:
  Train classes: (array([0, 1]), array([27557,   477]))
  Val classes: (array([0, 1]), array([6889,  120]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 0.9830, Prec: 1.0000, Rec: 0.0083, F1: 0.0165

Fold 4:
  Train classes: (array([0, 1]), array([27557,   478]))
  Val classes: (array([0, 1]), array([6889,  119]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 0.9833, Prec: 1.0000, Rec: 0.0168, F1: 0.0331

Fold 5:
  Train classes: (array([0, 1]), array([27557,   478]))
  Val classes: (array([0, 1]), array([6889,  119]))
  k-NN - Acc: 1.0000, Prec: 1.0000, Rec: 1.0000, F1: 1.0000
  NB  - Acc: 0.9833, Prec: 1.0000, Rec: 0.0168, F1: 0.0331

Test Set (8761 samples):
  k-NN - Acc: 0.9999, F1: 0.9967
  NB   - Acc: 0.9832, F1: 0.0392

================================================================================
CLASSIFYING: ICMP
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(40)}
Test set - Class distribution: {np.int64(0): np.int64(11)}

Fold 1:
  Train classes: (array([0]), array([32]))
  Val classes: (array([0]), array([8]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 2:
  Train classes: (array([0]), array([32]))
  Val classes: (array([0]), array([8]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 3:
  Train classes: (array([0]), array([32]))
  Val classes: (array([0]), array([8]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 4:
  Train classes: (array([0]), array([32]))
  Val classes: (array([0]), array([8]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 5:
  Train classes: (array([0]), array([32]))
  Val classes: (array([0]), array([8]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Test Set (11 samples):
  k-NN - Acc: 1.0000, F1: 0.0000
  NB   - Acc: 1.0000, F1: 0.0000

================================================================================
CLASSIFYING: SSH
================================================================================
Training set - Class distribution: {np.int64(0): np.int64(20682), np.int64(1): np.int64(2)}
Test set - Class distribution: {np.int64(0): np.int64(5170), np.int64(1): np.int64(1)}

Fold 1:
  Train classes: (array([0, 1]), array([16545,     2]))
  Val classes: (array([0]), array([4137]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 0.9993, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 2:
  Train classes: (array([0, 1]), array([16545,     2]))
  Val classes: (array([0]), array([4137]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 0.9998, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 3:
  Train classes: (array([0, 1]), array([16546,     1]))
  Val classes: (array([0, 1]), array([4136,    1]))
  k-NN - Acc: 0.9998, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 0.9993, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 4:
  Train classes: (array([0, 1]), array([16546,     1]))
  Val classes: (array([0, 1]), array([4136,    1]))
  k-NN - Acc: 0.9998, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 0.9990, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Fold 5:
  Train classes: (array([0, 1]), array([16546,     2]))
  Val classes: (array([0]), array([4136]))
  k-NN - Acc: 1.0000, Prec: 0.0000, Rec: 0.0000, F1: 0.0000
  NB  - Acc: 0.9998, Prec: 0.0000, Rec: 0.0000, F1: 0.0000

Test Set (5171 samples):
  k-NN - Acc: 0.9998, F1: 0.0000
  NB   - Acc: 0.9998, F1: 0.0000

================================================================================
DATASET ANALYSIS
================================================================================

HTTP:
  Training samples: 76209, Attack ratio: 0.026
  Test samples: 19053, Attack ratio: 0.026

IMAP:
  Training samples: 386, Attack ratio: 0.534
  Test samples: 97, Attack ratio: 0.536

DNS:
  Training samples: 154688, Attack ratio: 0.000
  Test samples: 38672, Attack ratio: 0.000

SMTP:
  Training samples: 35043, Attack ratio: 0.017
  Test samples: 8761, Attack ratio: 0.017

ICMP:
  Training samples: 40, Attack ratio: 0.000
  Test samples: 11, Attack ratio: 0.000
  WARNING: No attack samples in training set!
  WARNING: No attack samples in test set!

SSH:
  Training samples: 20684, Attack ratio: 0.000
  Test samples: 5171, Attack ratio: 0.000

================================================================================
MODEL RANKING AND IDS IMPLEMENTATION RECOMMENDATIONS
================================================================================

Performance on applications with attack samples:
k-NN  - Avg Acc: 0.9980, Avg F1: 0.7341
Naive Bayes - Avg Acc: 0.9914, Avg F1: 0.3373

 RECOMMENDED MODEL: k-NN (better F1-score)

APPLICATIONS WITH VALID RESULTS: ['HTTP', 'IMAP', 'DNS', 'SMTP', 'SSH']